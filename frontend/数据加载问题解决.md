# ⚠️ 数据没有加载？看这里！

## 🎯 问题原因

你只运行了 `npm run dev`，但是：

**前端需要两个服务同时运行：**
1. ✅ **API 服务器**（端口 4000）→ 提供数据
2. ✅ **前端服务器**（端口 5173）→ 显示界面

只启动前端，**没有数据源**，所以页面是空白的！

---

## 🚀 正确的启动方式

### 方式一：一键启动（推荐）⭐

**双击运行：**
```
启动系统.bat
```

这个脚本会自动帮你：
- ✅ 检查依赖
- ✅ 启动 API 服务器（4000端口）
- ✅ 启动前端（5173端口）
- ✅ 打开浏览器

---

### 方式二：手动启动（两个终端）

#### 第 1 步：启动 API 服务器

**打开第一个 PowerShell 终端：**
```powershell
cd d:\Desktop\贺绍凯的成长经历\计算机学习\java\20230271贺绍凯-基于命令行的学生成绩管理系统\frontend

npm run server
```

**看到这个提示说明成功：**
```
========================================
🎓 学生成绩管理系统 - Mock API Server
========================================
✅ Mock API Server running on http://localhost:4000
📊 Data initialized:
   - 300 Students
   - 5 Courses
   - 10 Teaching Classes
   - 1500 Grade Records
========================================
```

#### 第 2 步：启动前端

**保持第一个终端运行，打开第二个 PowerShell 终端：**
```powershell
cd d:\Desktop\贺绍凯的成长经历\计算机学习\java\20230271贺绍凯-基于命令行的学生成绩管理系统\frontend

npm run dev
```

**看到这个提示说明成功：**
```
  VITE v4.4.9  ready in 500 ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
```

#### 第 3 步：访问

浏览器打开：**http://localhost:5173**

---

## 🔍 如何确认问题已解决？

### 1. 检查两个终端都在运行
- 终端 1：显示 `Mock API Server running on http://localhost:4000`
- 终端 2：显示 `Local: http://localhost:5173/`

### 2. 测试 API 是否正常

在浏览器打开这些地址，应该能看到 JSON 数据：
```
http://localhost:4000/api/stats
http://localhost:4000/api/classes
http://localhost:4000/api/courses
```

### 3. 浏览器检查

访问 http://localhost:5173 后：
- ✅ 应该看到统计卡片（总学生数、总课程数等）
- ✅ 应该看到成绩分布图表
- ✅ 应该看到徽章展示

---

## 🛠️ 仍然没有数据？

### 运行诊断工具

双击运行：
```
检查问题.bat
```

这个工具会自动检查：
1. 依赖是否安装
2. API 服务器是否运行
3. API 是否可访问
4. 前端服务器是否运行

### 手动检查

#### 1. 打开浏览器开发者工具（F12）

**Console 选项卡：**
- 看是否有红色错误
- 常见错误：`Failed to fetch` → API 未启动
- 常见错误：`CORS error` → 跨域问题

**Network 选项卡：**
- 刷新页面
- 查看是否有红色的请求（Failed）
- 点击失败的请求查看详情

#### 2. 检查端口占用

```powershell
# 检查 4000 端口
netstat -ano | findstr :4000

# 检查 5173 端口
netstat -ano | findstr :5173
```

如果端口被占用，可以：
- 关闭占用端口的程序
- 或修改配置文件使用其他端口

---

## 📝 常见问题

### Q1: `npm run server` 报错
**原因：** 依赖未安装

**解决：**
```powershell
cd frontend
npm install
```

### Q2: 端口 4000 被占用
**解决方法 1：** 找到占用的程序并关闭
```powershell
netstat -ano | findstr :4000
# 查看 PID，然后在任务管理器中结束进程
```

**解决方法 2：** 修改端口
编辑 `frontend/server/server.js`：
```javascript
const port = 4001; // 改为其他端口
```

同时修改 `frontend/src/services/api.ts`：
```typescript
const API_BASE = 'http://localhost:4001/api' // 保持一致
```

### Q3: 防火墙阻止
**解决：**
- Windows 防火墙 → 允许 Node.js 通过
- 或临时关闭防火墙测试

### Q4: 浏览器缓存问题
**解决：**
- 按 Ctrl+Shift+R 强制刷新
- 或 F12 → Network → 勾选 "Disable cache"

---

## 🎉 成功标志

当一切正常时，你应该看到：

### 终端 1（API Server）
```
Mock API Server running on http://localhost:4000
Data initialized: 300 students, 5 courses
```

### 终端 2（Frontend）
```
VITE ready in 500 ms
Local: http://localhost:5173/
```

### 浏览器（http://localhost:5173）
- 📊 系统概览页面显示统计数据
- 📈 班级分布页面有图表
- 🔍 学生查询可以搜索
- 🏆 排行榜显示学生列表
- 📉 统计分析有多个图表

---

## 💡 小贴士

1. **保持两个终端运行**：关闭任何一个，数据都会丢失
2. **启动顺序**：先启动 API，再启动前端
3. **修改代码**：前端代码修改后自动刷新，API 代码需要重启
4. **查看日志**：终端会显示所有请求日志，方便调试

---

**还有问题？** 运行 `检查问题.bat` 获取详细诊断！
