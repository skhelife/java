# 📊 学生成绩管理系统 - 完整部署指南

> **实验四**: Spring Boot + React 前后端分离项目
> **数据规模**: 300名学生 + 完整RBAC权限系统 + 审计日志

---

## 🚀 快速启动 (推荐)

### 方式一: 一键部署
```bash
双击运行: 一键部署.bat
```

### 方式二: 手动部署

#### 1️⃣ 初始化数据库
```bash
cd backend
mysql -u root -p < init.sql
```

#### 2️⃣ 启动后端
```bash
cd backend
mvn spring-boot:run
```

#### 3️⃣ 启动前端
```bash
cd frontend
npm install  # 首次需要
npm run dev
```

---

## 📈 数据统计

### 核心数据
| 模块 | 数量 | 说明 |
|------|------|------|
| 👨‍🎓 学生 | **300人** | 学号: 20230001-20230300 |
| 👨‍🏫 教师 | 20人 | 包含教授、副教授、讲师 |
| 📚 课程 | 15门 | 涵盖数学、英语、专业课等 |
| 🏫 教学班 | 30个 | 2023春-2024春各学期 |
| 📝 成绩记录 | **1000+条** | 每个学生3-5门课程 |

### 权限系统
| 模块 | 数量 | 说明 |
|------|------|------|
| 👥 用户 | 19个 | 多角色测试账号 |
| 🎭 角色 | 6种 | 超管/管理员/教务/教师/学生/访客 |
| 🔐 权限 | 51项 | 完整权限树 |
| 📋 审计日志 | 30+条 | 操作记录/登录日志 |

---

## 👤 测试账号

> 所有账号密码都是: **123456**

### 管理员账号
| 账号 | 角色 | 权限范围 |
|------|------|----------|
| `super_admin` | 超级管理员 | ⭐ 所有权限 |
| `admin` | 管理员 | 日常管理权限 |
| `academic_admin` | 教务管理员 | 学生/教师/课程/成绩管理 |

### 教师账号
| 账号 | 角色 | 权限范围 |
|------|------|----------|
| `teacher01` - `teacher10` | 教师 | 查看学生，管理所授课程成绩 |

### 学生账号
| 账号 | 角色 | 权限范围 |
|------|------|----------|
| `student001` - `student005` | 学生 | 只能查看个人成绩 |

### 其他账号
| 账号 | 角色 | 权限范围 |
|------|------|----------|
| `guest` | 访客 | 只读权限 |

---

## 🎯 核心功能展示

### 1. 成绩管理 (300名学生)
- ✅ **分页查询**: 支持大数据量快速查询
- ✅ **批量导入**: Excel批量导入成绩
- ✅ **统计分析**: 成绩分布、排名、及格率
- ✅ **导出报表**: 导出Excel成绩单

### 2. 用户管理
- ✅ **用户列表**: 19个测试用户
- ✅ **角色分配**: 支持多角色授权
- ✅ **权限控制**: 细粒度权限管理
- ✅ **状态管理**: 启用/禁用用户

### 3. 角色权限
- ✅ **角色管理**: 6种预定义角色
- ✅ **权限树**: 51项权限的树形结构
- ✅ **动态授权**: 支持角色权限动态分配
- ✅ **权限继承**: 支持权限层级关系

### 4. 审计日志
- ✅ **操作记录**: 所有关键操作均有日志
- ✅ **登录日志**: 用户登录时间/IP记录
- ✅ **失败追踪**: 记录权限不足等失败操作
- ✅ **性能监控**: 记录操作执行时间

---

## 📊 数据库表结构

### 核心业务表
```
student          - 学生表 (300条记录)
teacher          - 教师表 (20条记录)
course           - 课程表 (15条记录)
teaching_class   - 教学班表 (30条记录)
grade            - 成绩表 (1000+条记录)
```

### 权限管理表
```
users            - 用户表 (19条记录)
roles            - 角色表 (6条记录)
permissions      - 权限表 (51条记录)
user_roles       - 用户角色关联表
role_permissions - 角色权限关联表
```

### 系统表
```
system_logs      - 系统日志表 (30+条记录)
```

---

## 🔑 权限说明

### 超级管理员 (super_admin)
- ✅ 所有模块的完整权限
- ✅ 系统配置修改权限
- ✅ 查看和导出所有日志

### 管理员 (admin)
- ✅ 用户/角色/权限管理
- ✅ 学生/教师/课程管理
- ✅ 成绩查看和统计
- ❌ 系统配置修改

### 教务管理员 (academic_admin)
- ✅ 学生信息管理
- ✅ 教师信息管理
- ✅ 课程/教学班管理
- ✅ 成绩查看、导入导出、统计
- ❌ 用户/角色/权限管理

### 教师 (teacher)
- ✅ 查看学生信息
- ✅ 管理所授课程成绩 (录入/修改)
- ✅ 导入导出成绩
- ✅ 成绩统计分析
- ❌ 删除成绩
- ❌ 用户管理

### 学生 (student)
- ✅ 查看个人成绩
- ✅ 导出个人成绩单
- ❌ 查看他人成绩
- ❌ 修改成绩

### 访客 (guest)
- ✅ 查看公开信息 (只读)
- ❌ 任何修改操作

---

## 🌐 访问地址

- **前端**: http://localhost:5173
- **后端API**: http://localhost:4000
- **API文档**: http://localhost:4000/swagger-ui.html (如已配置)

---

## 📝 API接口示例

### 登录
```bash
POST http://localhost:4000/api/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "123456"
}
```

### 查询成绩 (分页)
```bash
GET http://localhost:4000/api/grades?page=1&size=20
Authorization: Bearer <token>
```

### 查看审计日志
```bash
GET http://localhost:4000/api/logs?page=1&size=20
Authorization: Bearer <token>
```

---

## 🐛 常见问题

### 1. 数据库导入失败
**错误**: `ERROR 1406 (22001): Data too long for column 'gender'`

**解决**: 
```bash
# init.sql 已经包含 DROP DATABASE，会完全重建数据库
mysql -u root -p < init.sql
```

### 2. 后端编译失败
**错误**: Lombok相关错误

**解决**: 本项目已移除Lombok，使用手动getter/setter

### 3. 前端无法连接后端
**检查**:
- 后端是否启动 (端口4000)
- CORS配置是否正确
- API地址是否匹配

### 4. 权限不足
**检查**:
- 当前用户的角色
- 角色对应的权限列表
- JWT Token是否有效

---

## 📦 技术栈

### 后端
- Spring Boot 2.7.14
- Java 21
- MyBatis Plus 3.5.3.1
- MySQL 8.0
- JWT (jjwt 0.11.5)
- Druid 1.2.18

### 前端
- React 18
- TypeScript
- Vite
- Axios

---

## 📸 功能截图建议

1. **登录页面**: 多账号登录演示
2. **成绩管理**: 300名学生成绩列表（分页）
3. **成绩统计**: 图表展示成绩分布
4. **用户管理**: 用户列表和角色分配
5. **角色管理**: 角色权限树
6. **审计日志**: 操作日志列表

---

## ✅ 验证清单

- [ ] 数据库成功导入 (300学生 + 1000+成绩)
- [ ] 后端成功启动 (端口4000)
- [ ] 前端成功启动 (端口5173)
- [ ] 使用 admin 登录成功
- [ ] 查看学生列表 (显示300条)
- [ ] 查看成绩管理 (分页正常)
- [ ] 查看用户管理 (19个用户)
- [ ] 查看角色管理 (6个角色)
- [ ] 查看审计日志 (30+条记录)
- [ ] 权限控制正常 (学生无法修改成绩)

---

## 🎓 实验要点

本项目完整实现了:

✅ **实验一**: 学生成绩管理 (300名学生数据)
✅ **实验二**: RBAC权限管理系统 (6角色+51权限)
✅ **实验三**: React前端界面 (现代化UI)
✅ **实验四**: Spring Boot后端 (RESTful API)

**特色功能**:
- 大数据量支持 (300学生 + 1000+成绩)
- 完整权限体系 (用户-角色-权限三层)
- 操作审计追踪 (所有操作可追溯)
- 数据可视化展示 (图表统计分析)

---

## 📞 技术支持

如有问题，请检查:
1. MySQL服务是否运行
2. Java环境是否为JDK 21
3. Node.js版本是否 >= 16
4. 端口4000和5173是否被占用

---

**祝实验顺利！** 🎉
